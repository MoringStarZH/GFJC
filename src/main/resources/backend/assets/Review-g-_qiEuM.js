import{b as M,a as y,r as f,o as q,c as h,q as e,m as t,k as z,A,h as W,n,i as b,g as c,F as j,x as E,l as H,p as Y,j as G,e as J,_ as K}from"./index-kk0mXoR3.js";import{n as O,e as P,r as Q,o as X}from"./index-CWz7Ae3v.js";const Z=p=>(Y("data-v-9d8c8e03"),p=p(),G(),p),ee=Z(()=>J("span",{class:"text-gray-500"},"-",-1)),te=M({__name:"Review",setup(p){const{proxy:s}=z(),S=A(),o=y({workerId:"",advice:"",riskLevel:"",expectedTime1:"",expectedTime2:""}),V=f(""),d=f(),g=y([]),x=f(""),v=f(W()),L=async()=>{s.$startLoading();const r=await P({name:V.value,page:"1",pageSize:"100"});if(s.$closeLoading(),r.code!==1)return s.$message.error("获取列表失败");g.splice(0,g.length,...r.data.records)},T=async()=>{const r=new Date(o.expectedTime1),a=new Date(o.expectedTime2),u=`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;s.$startLoading();const w=await Q({advice:o.advice,expectedTime:u,workerId:o.workerId,id:d.value.id,status:"待专家审核",ifRepaired:d.value.ifRepair,ifReview:d.value.ifReview});return s.$closeLoading(),w.code!==1?s.$message.error("提交失败"):(v.value.push("/defect/management"),s.$message.success("审阅完成，等待接单"))},I=async()=>{if(s.$startLoading(),(await X(d.value.id)).code!==1)return s.$message.error("删除失败");s.$closeLoading(),s.$message.success("删除成功"),v.value.push("/defect/management")};return q(async()=>{L(),s.$startLoading();const r=await O(S.query.id);if(r.code!==1)return s.$message.error("服务器异常");d.value=r.data,console.log(d.value),x.value=d.value.riskLevel}),(r,a)=>{const u=n("el-breadcrumb-item"),w=n("el-breadcrumb"),k=n("el-button"),m=n("el-col"),R=n("el-row"),_=n("el-option"),$=n("el-select"),i=n("el-form-item"),C=n("el-date-picker"),D=n("el-time-picker"),U=n("el-input"),B=n("el-popconfirm"),F=n("el-form"),N=n("el-card");return b(),h("div",null,[e(w,{separator:"/"},{default:t(()=>[e(u,{to:{path:"/home"}},{default:t(()=>[c("首页")]),_:1}),e(u,null,{default:t(()=>[c("缺陷检测管理")]),_:1}),e(u,{to:{path:"/defect/management"}},{default:t(()=>[c("缺陷事件处理")]),_:1}),e(u,null,{default:t(()=>[c("事件审阅")]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(R,{gutter:20},{default:t(()=>[e(m,null,{default:t(()=>[e(k,{onClick:a[0]||(a[0]=l=>v.value.push("/defect/management"))},{default:t(()=>[c("返回")]),_:1})]),_:1})]),_:1}),e(F,{model:o,"label-position":"top",style:{"max-width":"600px"}},{default:t(()=>[e(i,{label:"调整风险等级"},{default:t(()=>[e($,{modelValue:o.riskLevel,"onUpdate:modelValue":a[1]||(a[1]=l=>o.riskLevel=l),placeholder:x.value,size:"large",style:{width:"240px"}},{default:t(()=>[e(_,{label:"一级风险",value:"一级风险"}),e(_,{label:"二级风险",value:"二级风险"}),e(_,{label:"三级风险",value:"三级风险"})]),_:1},8,["modelValue","placeholder"])]),_:1}),e(i,{label:"选择维修人员"},{default:t(()=>[e($,{modelValue:o.workerId,"onUpdate:modelValue":a[2]||(a[2]=l=>o.workerId=l),filterable:"",placeholder:"选择维修人员",style:{width:"240px"}},{default:t(()=>[(b(!0),h(j,null,E(g,l=>(b(),H(_,{key:l.value,label:l.nickName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"截止日期"},{default:t(()=>[e(m,{span:11},{default:t(()=>[e(C,{modelValue:o.expectedTime1,"onUpdate:modelValue":a[3]||(a[3]=l=>o.expectedTime1=l),type:"date",placeholder:"日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(m,{span:2,class:"text-center"},{default:t(()=>[ee]),_:1}),e(m,{span:11},{default:t(()=>[e(D,{modelValue:o.expectedTime2,"onUpdate:modelValue":a[4]||(a[4]=l=>o.expectedTime2=l),placeholder:"时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{label:"建议"},{default:t(()=>[e(U,{type:"textarea",modelValue:o.advice,"onUpdate:modelValue":a[5]||(a[5]=l=>o.advice=l)},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(k,{type:"primary",onClick:T},{default:t(()=>[c("完成审阅并生成工单")]),_:1}),e(B,{title:"Are you sure to delete this?",onConfirm:I},{reference:t(()=>[e(k,{type:"warning"},{default:t(()=>[c("误报删除")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),le=K(te,[["__scopeId","data-v-9d8c8e03"]]);export{le as default};
