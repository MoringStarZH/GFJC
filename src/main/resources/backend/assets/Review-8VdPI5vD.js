import{d as M,r as $,j as f,o as z,c as S,n as e,l as t,i as W,B as j,f as q,m as n,g as w,e as c,F as A,y as E,k as H,p as Y,h as G,a as J,_ as K}from"./index-D_0vH8B_.js";import{k as O,c as P,r as Q,m as X}from"./index-CM78VC0T.js";const Z=p=>(Y("data-v-bb1505b3"),p=p(),G(),p),ee=Z(()=>J("span",{class:"text-gray-500"},"-",-1)),te=M({__name:"Review",setup(p){const{proxy:s}=W(),V=j(),o=$({workId:"",advice:"",riskLevel:"",expectedTime1:"",expectedTime2:""}),h=f(""),d=f(),g=$([]),k=f(""),x=f(q()),L=async()=>{s.$startLoading();const r=await P({name:h.value,page:"1",pageSize:"100"});if(s.$closeLoading(),r.code!==1)return s.$message.error("获取列表失败");g.splice(0,g.length,...r.data.records)},T=async()=>{const r=new Date(o.expectedTime1),a=new Date(o.expectedTime2),i=`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;s.$startLoading();const v=await Q({advice:o.advice,expectedTime:i,workId:o.workId,id:d.value.id,status:"待专家审核",ifRepaired:d.value.ifRepair,ifReview:d.value.ifReview});return s.$closeLoading(),v.code!==1?s.$message.error("提交失败"):s.$message.success("审阅完成，等待接单")},I=async()=>{if(s.$startLoading(),(await X(d.value.id)).code!==1)return s.$message.error("删除失败");s.$closeLoading(),s.$message.success("删除成功"),x.value.push("/defect/management")};return z(async()=>{L(),s.$startLoading();const r=await O(V.query.id);if(r.code!==1)return s.$message.error("服务器异常");d.value=r.data,console.log(d.value),k.value=d.value.riskLevel}),(r,a)=>{const i=n("el-breadcrumb-item"),v=n("el-breadcrumb"),b=n("el-button"),m=n("el-col"),R=n("el-row"),_=n("el-option"),y=n("el-select"),u=n("el-form-item"),C=n("el-date-picker"),D=n("el-time-picker"),B=n("el-input"),U=n("el-popconfirm"),F=n("el-form"),N=n("el-card");return w(),S("div",null,[e(v,{separator:"/"},{default:t(()=>[e(i,{to:{path:"/home"}},{default:t(()=>[c("首页")]),_:1}),e(i,null,{default:t(()=>[c("缺陷检测管理")]),_:1}),e(i,{to:{path:"/defect/management"}},{default:t(()=>[c("缺陷事件处理")]),_:1}),e(i,null,{default:t(()=>[c("事件审阅")]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(R,{gutter:20},{default:t(()=>[e(m,null,{default:t(()=>[e(b,{onClick:a[0]||(a[0]=l=>x.value.push("/defect/management"))},{default:t(()=>[c("返回")]),_:1})]),_:1})]),_:1}),e(F,{model:o,"label-position":"top",style:{"max-width":"600px"}},{default:t(()=>[e(u,{label:"调整风险等级"},{default:t(()=>[e(y,{modelValue:o.riskLevel,"onUpdate:modelValue":a[1]||(a[1]=l=>o.riskLevel=l),placeholder:k.value,size:"large",style:{width:"240px"}},{default:t(()=>[e(_,{label:"一级风险",value:"一级风险"}),e(_,{label:"二级风险",value:"二级风险"}),e(_,{label:"三级风险",value:"三级风险"})]),_:1},8,["modelValue","placeholder"])]),_:1}),e(u,{label:"选择维修人员"},{default:t(()=>[e(y,{modelValue:o.workId,"onUpdate:modelValue":a[2]||(a[2]=l=>o.workId=l),filterable:"",placeholder:"选择维修人员",style:{width:"240px"}},{default:t(()=>[(w(!0),S(A,null,E(g,l=>(w(),H(_,{key:l.value,label:l.nickName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"截止日期"},{default:t(()=>[e(m,{span:11},{default:t(()=>[e(C,{modelValue:o.expectedTime1,"onUpdate:modelValue":a[3]||(a[3]=l=>o.expectedTime1=l),type:"date",placeholder:"日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(m,{span:2,class:"text-center"},{default:t(()=>[ee]),_:1}),e(m,{span:11},{default:t(()=>[e(D,{modelValue:o.expectedTime2,"onUpdate:modelValue":a[4]||(a[4]=l=>o.expectedTime2=l),placeholder:"时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{label:"建议"},{default:t(()=>[e(B,{type:"textarea",modelValue:o.advice,"onUpdate:modelValue":a[5]||(a[5]=l=>o.advice=l)},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(b,{type:"primary",onClick:T},{default:t(()=>[c("完成审阅并生成工单")]),_:1}),e(U,{title:"Are you sure to delete this?",onConfirm:I},{reference:t(()=>[e(b,{type:"warning"},{default:t(()=>[c("误报删除")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),le=K(te,[["__scopeId","data-v-bb1505b3"]]);export{le as default};
