import{b as P,a as y,r as w,o as G,c as H,q as e,m as l,n as r,i as J,g as m,u as p,s as K,e as Q,k as W}from"./index-kk0mXoR3.js";import{f as X,p as Y,q as Z,t as ee}from"./index-CWz7Ae3v.js";const te={class:"dialog-footer"},ne=P({__name:"Instrument",setup(le){const{proxy:n}=W();let d=y({name:"",page:1,pageSize:5}),$=w(1),V=y([]);const h=w(!1),C=y({}),k=w(),f=w(!1),s=y({name:"",model:"",propertyType:"",description:""});async function u(){n.$startLoading();const a=await X(d);if(n.$closeLoading(),a.code!==1)return n.$message.error("获取列表失败");V.splice(0,V.length,...a.data.records),$.value=a.data.total}async function x(a){n.$startLoading();const o=await Y(a.id);if(n.$closeLoading(),o.code!==1)return n.$message.error("服务器故障");n.$message.success("删除成功"),u()}const L=a=>{a.resetFields()},U=async()=>{if(s.name===""||s.modle===""||s.propertyType==="")return n.$message.warning("请填写完整信息");n.$startLoading();const a=await Z(s);if(n.$closeLoading(),a.code!==0)return n.$message.error("新增失败");n.$message.success("添加成功"),u(),f.value=!1};function I(a){Object.assign(C,a),F()}const T=a=>{d.pageSize=a,u()},S=a=>{d.page=a,u()};G(()=>{u()});async function F(){n.$startLoading();const a=await ee({...C});if(n.$closeLoading(),h.value=!1,a.code!=1)return n.$message.error("更新失败");n.$message.success("更新成功"),u()}function j(a){Object.assign(C,a),h.value=!0}return(a,o)=>{const v=r("el-breadcrumb-item"),q=r("el-breadcrumb"),c=r("el-button"),g=r("el-input"),z=r("el-col"),B=r("el-row"),i=r("el-table-column"),D=r("el-switch"),E=r("el-popconfirm"),N=r("el-table"),O=r("el-pagination"),R=r("el-card"),_=r("el-form-item"),A=r("el-form"),M=r("el-dialog");return J(),H("div",null,[e(q,{separator:"/"},{default:l(()=>[e(v,{to:{path:"/home"}},{default:l(()=>[m("首页")]),_:1}),e(v,null,{default:l(()=>[m("系统管理")]),_:1}),e(v,null,{default:l(()=>[m("机构管理")]),_:1})]),_:1}),e(R,null,{default:l(()=>[e(B,{gutter:20},{default:l(()=>[e(z,{span:8,offset:0},{default:l(()=>[e(g,{placeholder:"输入机构名查询",modelValue:p(d).name,"onUpdate:modelValue":o[0]||(o[0]=t=>p(d).name=t),clearable:"",onClear:u},{append:l(()=>[e(c,{icon:p(K),onClick:u},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(z,{span:4,offset:0},{default:l(()=>[e(c,{type:"primary",onClick:o[1]||(o[1]=t=>f.value=!0)},{default:l(()=>[m("新增")]),_:1})]),_:1})]),_:1}),e(N,{data:p(V),stripe:"",border:"",fit:"",style:{width:"100%"}},{default:l(()=>[e(i,{fixed:"",type:"index",sortable:"",label:"序号",align:"center",width:"100"}),e(i,{prop:"id",label:"id",align:"center",width:"200"}),e(i,{prop:"name",label:"名字",align:"center",width:"150"}),e(i,{prop:"model",label:"设备型号",align:"center",width:"150"}),e(i,{prop:"propertyType",label:"资产类型",align:"center",width:"150"}),e(i,{prop:"description",label:"描述",align:"center",width:"500"}),e(i,{prop:"createTime",sortable:"",label:"创建时间",align:"center",width:"250"}),e(i,{prop:"updateTime",sortable:"",label:"最后更新时间",align:"center",width:"250"}),e(i,{prop:"status",label:"状态",align:"center",width:"150"},{default:l(t=>[e(D,{modelValue:t.row.status,"onUpdate:modelValue":b=>t.row.status=b,style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-value":1,"inactive-value":0,onClick:b=>I(t.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),e(i,{fixed:"right",label:"操作",width:"120",align:"center"},{default:l(t=>[e(c,{link:"",type:"primary",size:"small",onClick:b=>j(t.row)},{default:l(()=>[m("编辑")]),_:2},1032,["onClick"]),e(E,{title:"是否确定删除",onConfirm:b=>x(t.row)},{reference:l(()=>[e(c,{link:"",type:"primary",size:"small"},{default:l(()=>[m("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(O,{"current-page":p(d).page,"onUpdate:currentPage":o[2]||(o[2]=t=>p(d).page=t),"page-size":p(d).pageSize,"onUpdate:pageSize":o[3]||(o[3]=t=>p(d).pageSize=t),"page-sizes":[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper",total:p($),onSizeChange:T,onCurrentChange:S},null,8,["current-page","page-size","total"])]),_:1}),e(M,{"align-center":"",title:"新增设备",modelValue:f.value,"onUpdate:modelValue":o[9]||(o[9]=t=>f.value=t),width:"40%",onClose:o[10]||(o[10]=t=>L(k.value))},{footer:l(()=>[Q("span",te,[e(c,{onClick:o[8]||(o[8]=t=>f.value=!1)},{default:l(()=>[m("取 消")]),_:1}),e(c,{type:"primary",onClick:U},{default:l(()=>[m("确 定")]),_:1})])]),default:l(()=>[e(A,{model:s,ref_key:"addFormRef",ref:k,"label-width":"100px"},{default:l(()=>[e(_,{label:"设备名称",prop:"name"},{default:l(()=>[e(g,{modelValue:s.name,"onUpdate:modelValue":o[4]||(o[4]=t=>s.name=t)},null,8,["modelValue"])]),_:1}),e(_,{label:"设备型号",prop:"model"},{default:l(()=>[e(g,{modelValue:s.phone,"onUpdate:modelValue":o[5]||(o[5]=t=>s.phone=t)},null,8,["modelValue"])]),_:1}),e(_,{label:"资产类型",prop:"propertyType"},{default:l(()=>[e(g,{modelValue:s.propertyType,"onUpdate:modelValue":o[6]||(o[6]=t=>s.propertyType=t)},null,8,["modelValue"])]),_:1}),e(_,{label:"描述",prop:"description"},{default:l(()=>[e(g,{type:"textarea",modelValue:s.description,"onUpdate:modelValue":o[7]||(o[7]=t=>s.description=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{ne as default};
