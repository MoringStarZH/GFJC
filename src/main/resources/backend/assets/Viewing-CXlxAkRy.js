import{j as M,k as O}from"./index-CM78VC0T.js";import{d as W,r as y,j as h,o as A,c as G,n as e,l as t,m as p,g as I,e as a,u as g,t as i,a as H,k as J,z as K,i as Q}from"./index-D_0vH8B_.js";const X={class:"dialog-footer"},le=W({__name:"Viewing",setup(Y){const{proxy:f}=Q();let u=y({name:"",page:1,pageSize:10}),z=h(1),m=y([]);h("https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg");const C=h(),b=h(!1),l=y({});async function x(){f.$startLoading();const o=await M(u);if(f.$closeLoading(),o.code!==1)return f.$message.error("获取列表失败");m.splice(0,m.length,...o.data.records),z.value=o.data.total,m.forEach(n=>{n.size=n.size.replace(/;/g,`
`),n.userInfo=n.userInfo.replace(/;/g,`
`)})}const _=/(?:巡检人|会审专家|维修人员)\s?: *(.*?); *电话: *(\d+)/g,T=o=>{u.pageSize=o,x()},L=o=>{u.page=o,x()};function N(o,n){return n.riskLevel===o}function S(o,n){return n.defectType===o}async function V(o){f.$startLoading();const n=await O(o.id);if(f.$closeLoading(),console.log(n),n.code!==1)return f.$message.error("服务器故障");Object.assign(l,n.data),_.lastIndex=0;let d=_.exec(l.inspectedInfo);d&&(l.inspectedName=d[1].trim(),l.inspectedPhone=d[2]),_.lastIndex=0,d=_.exec(l.expertInfo),d&&(l.expertName=d[1].trim(),l.expertPhone=d[2]),_.lastIndex=0,d=_.exec(l.workerInfo),d&&(l.workerName=d[1].trim(),l.workerPhone=d[2]),b.value=!0}function U(o){return o.riskLevel==="一级风险"?"info":o.riskLevel==="二级风险"?"warning":"danger"}const P=()=>{C.value.clearFilter()};return A(()=>{x()}),(o,n)=>{const d=p("el-breadcrumb-item"),$=p("el-breadcrumb"),v=p("el-button"),j=p("el-col"),B=p("el-row"),c=p("el-table-column"),R=p("el-tag"),k=p("el-image"),D=p("el-table"),E=p("el-pagination"),F=p("el-card"),s=p("el-descriptions-item"),w=p("el-descriptions"),q=p("el-dialog");return I(),G("div",null,[e($,{separator:"/"},{default:t(()=>[e(d,{to:{path:"/home"}},{default:t(()=>[a("首页")]),_:1}),e(d,null,{default:t(()=>[a("系统管理")]),_:1}),e(d,null,{default:t(()=>[a("机构管理")]),_:1})]),_:1}),e(F,null,{default:t(()=>[e(B,{gutter:20},{default:t(()=>[e(j,{span:5},{default:t(()=>[e(v,{onClick:P},{default:t(()=>[a("重置过滤器")]),_:1})]),_:1})]),_:1}),e(D,{ref_key:"tableRef",ref:C,data:g(m),stripe:"",border:"",fit:"",style:{width:"100%"}},{default:t(()=>[e(c,{fixed:"",type:"index",sortable:"",label:"序号",align:"center",width:"100"}),e(c,{prop:"id",label:"id",align:"center",width:"300"}),e(c,{prop:"size",label:"图片大小",align:"center",width:"250"}),e(c,{prop:"userInfo",label:"用户信息",align:"center",width:"150"}),e(c,{prop:"defectType",filters:[{text:"裂痕",value:"裂痕"},{text:"物理损坏",value:"物理损坏"},{text:"电气损坏",value:"电气损坏"},{text:"脏污",value:"脏污"},{text:"积雪覆盖",value:"积雪覆盖"},{text:"清洁",value:"清洁"}],label:"缺陷类型",align:"center",width:"150","filter-method":S}),e(c,{prop:"riskLevel",filters:[{text:"一级风险",value:"一级风险"},{text:"二级风险",value:"二级风险"},{text:"三级风险",value:"三级风险"}],label:"风险等级",align:"center",width:"150","filter-method":N},{default:t(r=>[e(R,{type:U(r.row),"disable-transitions":""},{default:t(()=>[a(i(r.row.riskLevel),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"instrumentType",label:"设备类型",align:"center",width:"150"}),e(c,{prop:"uploadType",label:"来源",align:"center",width:"100"}),e(c,{label:"原始图片",width:"100"},{default:t(r=>[e(k,{style:{width:"60px",height:"60px"},src:r.row.originalUrl,"preview-src-list":[r.row.originalUrl]},null,8,["src","preview-src-list"])]),_:1}),e(c,{label:"分析后图片",width:"100"},{default:t(r=>[e(k,{style:{width:"60px",height:"60px"},src:r.row.analyzedUrl,"preview-src-list":[r.row.analyzedUrl]},null,8,["src","preview-src-list"])]),_:1}),e(c,{label:"维修后图片",width:"100"},{default:t(r=>[e(k,{style:{width:"60px",height:"60px"},src:r.row.repairedUrl,"preview-src-list":[r.row.repairedUrl]},null,8,["src","preview-src-list"])]),_:1}),e(c,{prop:"description",label:"描述",align:"center",width:"300"}),e(c,{prop:"createTime",sortable:"",label:"创建时间",align:"center",width:"250"}),e(c,{prop:"updateTime",sortable:"",label:"最后更新时间",align:"center",width:"250"}),e(c,{fixed:"right",label:"操作",width:"120",align:"center"},{default:t(r=>[e(v,{link:"",type:"primary",size:"small",onClick:Z=>V(r.row)},{default:t(()=>[a("查看")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(E,{"current-page":g(u).page,"onUpdate:currentPage":n[0]||(n[0]=r=>g(u).page=r),"page-size":g(u).pageSize,"onUpdate:pageSize":n[1]||(n[1]=r=>g(u).pageSize=r),"page-sizes":[10,20,40,60],layout:"total, sizes, prev, pager, next, jumper",total:g(z),onSizeChange:T,onCurrentChange:L},null,8,["current-page","page-size","total"])]),_:1}),e(q,{"align-center":"",modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=r=>b.value=r),width:"50%"},{footer:t(()=>[H("span",X,[e(v,{onClick:n[2]||(n[2]=r=>b.value=!1)},{default:t(()=>[a("取 消")]),_:1})])]),default:t(()=>[e(w,{title:"基础信息"},{default:t(()=>[e(s,{label:"编号"},{default:t(()=>[a(i(l.id),1)]),_:1}),e(s,{label:"图片编号"},{default:t(()=>[a(i(l.id),1)]),_:1}),l.defectType?(I(),J(s,{key:0,label:"缺陷类型"},{default:t(()=>[a(i(l.id),1)]),_:1})):K("",!0),e(s,{label:"维修时间"},{default:t(()=>[a(i(l.expectedTime),1)]),_:1}),e(s,{label:"状态"},{default:t(()=>[a(i(l.status),1)]),_:1}),e(s,{label:"创建时间"},{default:t(()=>[a(i(l.createTime),1)]),_:1}),e(s,{label:"更新时间"},{default:t(()=>[a(i(l.updateTime),1)]),_:1})]),_:1}),e(w,{title:"巡检人员"},{default:t(()=>[e(s,{label:"编号："},{default:t(()=>[a(i(l.inspectId),1)]),_:1}),e(s,{label:"姓名："},{default:t(()=>[a(i(l.inspectedName),1)]),_:1}),e(s,{label:"电话："},{default:t(()=>[a(i(l.inspectedPhone),1)]),_:1})]),_:1}),e(w,{title:"审查人员"},{default:t(()=>[e(s,{label:"编号："},{default:t(()=>[a(i(l.expertId),1)]),_:1}),e(s,{label:"姓名："},{default:t(()=>[a(i(l.expertName),1)]),_:1}),e(s,{label:"电话："},{default:t(()=>[a(i(l.expertPhone),1)]),_:1})]),_:1}),e(w,{title:"维修人员"},{default:t(()=>[e(s,{label:"编号："},{default:t(()=>[a(i(l.workerId),1)]),_:1}),e(s,{label:"姓名："},{default:t(()=>[a(i(l.workerName),1)]),_:1}),e(s,{label:"电话："},{default:t(()=>[a(i(l.workerPhone),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{le as default};
